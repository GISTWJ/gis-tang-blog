import{_ as t}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as p,o as e,c as o,a as n,d as s,b as c,e as l}from"./app-DVIbrNyI.js";const i="/assets/image-20230712192205823-C8ciBdOD.png",u={},r=n("h1",{id:"_14、飞行航线追踪",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_14、飞行航线追踪"},[n("span",null,"14、飞行航线追踪")])],-1),k=n("p",null,"可视化从旧金山到哥本哈根的真实航班。",-1),d={href:"https://cesium.com/learn/cesiumjs-learn/cesiumjs-flight-tracker/",target:"_blank",rel:"noopener noreferrer"},m=l(`<p>2、在地图上添加飞行点位：循环遍历点位数据，利用Entity直接添加点至地图上。</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token comment">//添加飞行点位</span>
<span class="token keyword">const</span> <span class="token function-variable function">addFlightPoint</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> length <span class="token operator">=</span> filghtData<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> dataPoint <span class="token operator">=</span> filghtData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    viewer<span class="token punctuation">.</span>entities<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      description<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">Location:(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>dataPoint<span class="token punctuation">.</span>longitude<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>dataPoint<span class="token punctuation">.</span>latitude<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>dataPoint<span class="token punctuation">.</span>height<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
      position<span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span>
        dataPoint<span class="token punctuation">.</span>longitude<span class="token punctuation">,</span> <span class="token comment">//经度</span>
        dataPoint<span class="token punctuation">.</span>latitude<span class="token punctuation">,</span> <span class="token comment">//纬度</span>
        dataPoint<span class="token punctuation">.</span>height <span class="token comment">//高度</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
      point<span class="token operator">:</span> <span class="token punctuation">{</span>
        pixelSize<span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token comment">//点尺寸</span>
        color<span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Color<span class="token punctuation">.</span><span class="token constant">RED</span><span class="token punctuation">,</span> <span class="token comment">//点颜色</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3、将飞行点位连接起来，并创建飞行移动实体：</p><ul><li>假设雷达样本采样间隔为30s,设定飞行开始时间，飞行结束时间由飞行开始时间+飞行持续时间计算出来。</li><li>将开始、结束时间绑定到viewer的时间轴上去，调整时间速率，开启时间动画。</li><li>利用采样位置属性实例<code>Cesium.SampledPositionProperty()</code>，循环遍历将所有点与时间创建成样本实例并利用<code>addSample()</code>添加进采样位置属性实例。</li><li>创建飞机模型实例，绑定时间间隔集合。利用<code> Cesium.VelocityOrientationProperty()</code>将飞机实体方向设置为样本一致。</li><li>创建飞行路线，利用<code>Cesium.PathGraphics({ width: 3 })</code>设置线条宽度为3.</li><li>利用 <code>viewer.trackedEntity = airPlaneEntity</code>设置相机视角跟随飞机实体。</li></ul><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token comment">//将飞行点位连接起来，并创建飞行移动实体</span>
<span class="token keyword">const</span> <span class="token function-variable function">createFlyLine</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> length <span class="token operator">=</span> filghtData<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">const</span> timeStepInSeconds <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span> <span class="token comment">//雷达样本间隔</span>
  <span class="token keyword">const</span> totalSeconds <span class="token operator">=</span> timeStepInSeconds <span class="token operator">*</span> <span class="token punctuation">(</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//飞行的持续时间</span>
  <span class="token keyword">const</span> start <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>JulianDate<span class="token punctuation">.</span><span class="token function">fromIso8601</span><span class="token punctuation">(</span><span class="token string">&quot;2022-12-17T23:10:00Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//飞行开始时间</span>
  <span class="token keyword">const</span> stop <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>JulianDate<span class="token punctuation">.</span><span class="token function">addSeconds</span><span class="token punctuation">(</span>
    start<span class="token punctuation">,</span>
    totalSeconds<span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">Cesium</span><span class="token punctuation">.</span><span class="token function">JulianDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//通过计算获得飞行结束时间</span>

  viewer<span class="token punctuation">.</span>clock<span class="token punctuation">.</span>startTime <span class="token operator">=</span> start<span class="token punctuation">;</span> <span class="token comment">//开始时间</span>
  viewer<span class="token punctuation">.</span>clock<span class="token punctuation">.</span>stopTime <span class="token operator">=</span> stop<span class="token punctuation">;</span> <span class="token comment">//停止时间</span>
  viewer<span class="token punctuation">.</span>clock<span class="token punctuation">.</span>currentTime <span class="token operator">=</span> start<span class="token punctuation">;</span> <span class="token comment">//当前时间</span>
  viewer<span class="token punctuation">.</span>timeline<span class="token punctuation">.</span><span class="token function">zoomTo</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> stop<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将视图设置为提供的时间。</span>

  viewer<span class="token punctuation">.</span>clock<span class="token punctuation">.</span>multiplier <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span> <span class="token comment">//加快播放速度</span>
  viewer<span class="token punctuation">.</span>clock<span class="token punctuation">.</span>shouldAnimate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">//时针向前走</span>
  <span class="token comment">//创建采样位置属性实例</span>
  <span class="token keyword">const</span> positionProperty <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium</span><span class="token punctuation">.</span><span class="token function">SampledPositionProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> dataPoint <span class="token operator">=</span> filghtData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> time <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>JulianDate<span class="token punctuation">.</span><span class="token function">addSeconds</span><span class="token punctuation">(</span>
      start<span class="token punctuation">,</span>
      i <span class="token operator">*</span> timeStepInSeconds<span class="token punctuation">,</span>
      <span class="token keyword">new</span> <span class="token class-name">Cesium</span><span class="token punctuation">.</span><span class="token function">JulianDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> position <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span>
      dataPoint<span class="token punctuation">.</span>longitude<span class="token punctuation">,</span>
      dataPoint<span class="token punctuation">.</span>latitude<span class="token punctuation">,</span>
      dataPoint<span class="token punctuation">.</span>height
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    positionProperty<span class="token punctuation">.</span><span class="token function">addSample</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> position<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//调用addSample方法将样本实例添加进去</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//添加飞机模型</span>
  <span class="token comment">// const airPlaneUri = Cesium.IonResource.fromAssetId(1980066).then((a)=&gt;{return a});</span>
  <span class="token comment">// console.log(airPlaneUri);</span>

  <span class="token keyword">const</span> airPlaneEntity <span class="token operator">=</span> viewer<span class="token punctuation">.</span>entities<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">//创建时间间隔集合</span>
    availability<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium</span><span class="token punctuation">.</span><span class="token function">TimeIntervalCollection</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">Cesium</span><span class="token punctuation">.</span><span class="token function">TimeInterval</span><span class="token punctuation">(</span><span class="token punctuation">{</span> start<span class="token operator">:</span> start<span class="token punctuation">,</span> stop<span class="token operator">:</span> stop <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//创建时间间隔</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    position<span class="token operator">:</span> positionProperty<span class="token punctuation">,</span>
    <span class="token comment">//添加飞机模型</span>
    model<span class="token operator">:</span> <span class="token punctuation">{</span>
      uri<span class="token operator">:</span> <span class="token string">&quot;../public/GLB/Cesium_Air.glb&quot;</span><span class="token punctuation">,</span>
      minimumPixelSize<span class="token operator">:</span> <span class="token number">128</span><span class="token punctuation">,</span>
      maximumScale<span class="token operator">:</span> <span class="token number">20000</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    orientation<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium</span><span class="token punctuation">.</span><span class="token function">VelocityOrientationProperty</span><span class="token punctuation">(</span>positionProperty<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//设置方向与采样属性一致</span>
    path<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium</span><span class="token punctuation">.</span><span class="token function">PathGraphics</span><span class="token punctuation">(</span><span class="token punctuation">{</span> width<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//路径图形，并宽度为3</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  viewer<span class="token punctuation">.</span>trackedEntity <span class="token operator">=</span> airPlaneEntity<span class="token punctuation">;</span> <span class="token comment">//视角跟随飞机实体</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>4、添加三维建筑、地形图层：</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token comment">//添加三维建筑</span>
<span class="token keyword">const</span> <span class="token function-variable function">loadOSMBuildings</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
    <span class="token keyword">await</span> Cesium<span class="token punctuation">.</span>Cesium3DTileset<span class="token punctuation">.</span><span class="token function">fromIonAssetId</span><span class="token punctuation">(</span><span class="token number">96188</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      show<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//添加地形</span>
<span class="token keyword">const</span> <span class="token function-variable function">addTerrainProvider</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  viewer<span class="token punctuation">.</span>terrainProvider <span class="token operator">=</span>
    <span class="token keyword">await</span> Cesium<span class="token punctuation">.</span>ArcGISTiledElevationTerrainProvider<span class="token punctuation">.</span><span class="token function">fromUrl</span><span class="token punctuation">(</span>
      <span class="token string">&quot;https://elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        token<span class="token operator">:</span>
          <span class="token string">&quot;KED1aF_I4UzXOHy3BnhwyBHU4l5oY6rO6walkmHoYqGp4XyIWUd5YZUC1ZrLAzvV40pR6gBXQayh0eFA8m6vPg..&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+i+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>附：完整代码：</p><div class="language-vue line-numbers-mode" data-ext="vue" data-title="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>view_container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> Cesium <span class="token keyword">from</span> <span class="token string">&quot;cesium&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;../public/Widgets/widgets.css&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> onMounted <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> filghtData <span class="token keyword">from</span> <span class="token string">&quot;../public/JSON/flightData.json&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token literal-property property">viewer</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Viewer<span class="token punctuation">;</span> <span class="token comment">//地图实例</span>

<span class="token comment">//中国地图JSON：https://geo.datav.aliyun.com/areas_v3/bound/100000_full.json</span>
<span class="token comment">//1、加载静态资源</span>
window<span class="token punctuation">.</span><span class="token constant">CESIUM_BASE_URL</span> <span class="token operator">=</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//2、添加令牌</span>
Cesium<span class="token punctuation">.</span>Ion<span class="token punctuation">.</span>defaultAccessToken <span class="token operator">=</span>
  <span class="token string">&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJjYTVhNjE0YS02YWVhLTQxNTAtYWI5NS1jYzUwMzliNmRjYjciLCJpZCI6OTc4NDgsImlhdCI6MTY1NTM4NDM0OH0.aT_4OCAgJ95R0l6Tg--u4jo9Ky6TlFa40p-8OxzYy2M&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//3、设置地图初始默认视角</span>
Cesium<span class="token punctuation">.</span>Camera<span class="token punctuation">.</span><span class="token constant">DEFAULT_VIEW_RECTANGLE</span> <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Rectangle<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span>
  <span class="token number">73.5</span><span class="token punctuation">,</span> <span class="token comment">//西经</span>
  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token comment">//南纬</span>
  <span class="token number">135.4</span><span class="token punctuation">,</span> <span class="token comment">//东经</span>
  <span class="token number">53.5</span> <span class="token comment">//北纬</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//5、创建并初始化viewer实例</span>
  viewer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Viewer</span><span class="token punctuation">(</span><span class="token string">&quot;view_container&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">infoBox</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//小弹窗</span>
    <span class="token comment">// animation: false, //左下角动画仪表盘</span>
    <span class="token literal-property property">baseLayerPicker</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//右上角图层选择按钮</span>
    <span class="token literal-property property">geocoder</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//搜索框</span>
    <span class="token literal-property property">homeButton</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//home按钮</span>
    <span class="token literal-property property">sceneModePicker</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//模式切换按钮</span>
    <span class="token comment">// timeline: false, //底部时间轴</span>
    <span class="token literal-property property">navigationHelpButton</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//右上角帮助按钮</span>
    <span class="token literal-property property">fullscreenButton</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//右下角全屏按钮</span>
    <span class="token literal-property property">selectionIndicator</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//选择指示器</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//6、隐藏logo</span>
  <span class="token punctuation">(</span>viewer<span class="token punctuation">.</span>cesiumWidget<span class="token punctuation">.</span>creditContainer <span class="token keyword">as</span> HTMLElement<span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">;</span>
  <span class="token function">loadGeoJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">loadCZML</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">addFlightPoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">createFlyLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">loadOSMBuildings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">addTerrainProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//7、加载GeoJSON数据</span>
<span class="token keyword">const</span> <span class="token function-variable function">loadGeoJSON</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// viewer.dataSources.add(Cesium.GeoJsonDataSource.load(&#39;https://geo.datav.aliyun.com/areas_v3/bound/100000_full.json&#39;,{</span>
  <span class="token comment">//   stroke:Cesium.Color.fromCssColorString(&#39;#048dfa&#39;),//折线和多边形轮廓的默认颜色。</span>
  <span class="token comment">//   fill:Cesium.Color.fromCssColorString(&#39;#afd6f0&#39;),//填充颜色#048dfa</span>
  <span class="token comment">//   strokeWidth:3,//轮廓宽度</span>
  <span class="token comment">//   markerSymbol:&#39;?&#39;,//为每个点创建的地图图钉的默认符号。</span>
  <span class="token comment">// }));</span>
  <span class="token comment">//因为加载是Ajax请求，所以可以使用以下方式加载</span>
  Cesium<span class="token punctuation">.</span>GeoJsonDataSource<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>
    <span class="token string">&quot;https://geo.datav.aliyun.com/areas_v3/bound/100000_full.json&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">stroke</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Color<span class="token punctuation">.</span><span class="token function">fromCssColorString</span><span class="token punctuation">(</span><span class="token string">&quot;#048dfa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//折线和多边形轮廓的默认颜色。</span>
      <span class="token literal-property property">fill</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Color<span class="token punctuation">.</span><span class="token function">fromCssColorString</span><span class="token punctuation">(</span><span class="token string">&quot;#afd6f0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//填充颜色#048dfa</span>
      <span class="token literal-property property">strokeWidth</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token comment">//轮廓宽度</span>
      <span class="token literal-property property">markerSymbol</span><span class="token operator">:</span> <span class="token string">&quot;?&quot;</span><span class="token punctuation">,</span> <span class="token comment">//为每个点创建的地图图钉的默认符号。</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">dataSources</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>GeoJsonDataSource</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    viewer<span class="token punctuation">.</span>dataSources<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>dataSources<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//8、加载KML</span>
<span class="token comment">//9、加载czml</span>
<span class="token keyword">const</span> czml <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;document&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;box&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">version</span><span class="token operator">:</span> <span class="token string">&quot;1.0&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;shape1&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Blue box&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">cartographicDegrees</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">114.0</span><span class="token punctuation">,</span> <span class="token number">40.0</span><span class="token punctuation">,</span> <span class="token number">300000.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">box</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">dimensions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">cartesian</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">400000.0</span><span class="token punctuation">,</span> <span class="token number">300000.0</span><span class="token punctuation">,</span> <span class="token number">500000.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">material</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">solidColor</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">rgba</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;shape2&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Red box with black outline&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">cartographicDegrees</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">107.0</span><span class="token punctuation">,</span> <span class="token number">40.0</span><span class="token punctuation">,</span> <span class="token number">300000.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">box</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">dimensions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">cartesian</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">400000.0</span><span class="token punctuation">,</span> <span class="token number">300000.0</span><span class="token punctuation">,</span> <span class="token number">500000.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">material</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">solidColor</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">rgba</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">outline</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token literal-property property">outlineColor</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">rgba</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;shape3&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Yellow box outline&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">cartographicDegrees</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">100.0</span><span class="token punctuation">,</span> <span class="token number">40.0</span><span class="token punctuation">,</span> <span class="token number">300000.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">box</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">dimensions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">cartesian</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">400000.0</span><span class="token punctuation">,</span> <span class="token number">300000.0</span><span class="token punctuation">,</span> <span class="token number">500000.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token literal-property property">outline</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token literal-property property">outlineColor</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">rgba</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">loadCZML</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  Cesium<span class="token punctuation">.</span>CzmlDataSource<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>czml<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">datasoutcePromise</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>CzmlDataSource</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      viewer<span class="token punctuation">.</span>dataSources<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>datasoutcePromise<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//10、添加飞行点位</span>
<span class="token keyword">const</span> <span class="token function-variable function">addFlightPoint</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> length <span class="token operator">=</span> filghtData<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> dataPoint <span class="token operator">=</span> filghtData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    viewer<span class="token punctuation">.</span>entities<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">Location:(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>dataPoint<span class="token punctuation">.</span>longitude<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>dataPoint<span class="token punctuation">.</span>latitude<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>dataPoint<span class="token punctuation">.</span>height<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">position</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span>
        dataPoint<span class="token punctuation">.</span>longitude<span class="token punctuation">,</span> <span class="token comment">//经度</span>
        dataPoint<span class="token punctuation">.</span>latitude<span class="token punctuation">,</span> <span class="token comment">//纬度</span>
        dataPoint<span class="token punctuation">.</span>height <span class="token comment">//高度</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">point</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">pixelSize</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token comment">//点尺寸</span>
        <span class="token literal-property property">color</span><span class="token operator">:</span> Cesium<span class="token punctuation">.</span>Color<span class="token punctuation">.</span><span class="token constant">RED</span><span class="token punctuation">,</span> <span class="token comment">//点颜色</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//11、将飞行点位连接起来，并创建飞行移动实体</span>
<span class="token keyword">const</span> <span class="token function-variable function">createFlyLine</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> length <span class="token operator">=</span> filghtData<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">const</span> timeStepInSeconds <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span> <span class="token comment">//雷达样本间隔</span>
  <span class="token keyword">const</span> totalSeconds <span class="token operator">=</span> timeStepInSeconds <span class="token operator">*</span> <span class="token punctuation">(</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//飞行的持续时间</span>
  <span class="token keyword">const</span> start <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>JulianDate<span class="token punctuation">.</span><span class="token function">fromIso8601</span><span class="token punctuation">(</span><span class="token string">&quot;2022-12-17T23:10:00Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//飞行开始时间</span>
  <span class="token keyword">const</span> stop <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>JulianDate<span class="token punctuation">.</span><span class="token function">addSeconds</span><span class="token punctuation">(</span>
    start<span class="token punctuation">,</span>
    totalSeconds<span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>JulianDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//通过计算获得飞行结束时间</span>

  viewer<span class="token punctuation">.</span>clock<span class="token punctuation">.</span>startTime <span class="token operator">=</span> start<span class="token punctuation">;</span> <span class="token comment">//开始时间</span>
  viewer<span class="token punctuation">.</span>clock<span class="token punctuation">.</span>stopTime <span class="token operator">=</span> stop<span class="token punctuation">;</span> <span class="token comment">//停止时间</span>
  viewer<span class="token punctuation">.</span>clock<span class="token punctuation">.</span>currentTime <span class="token operator">=</span> start<span class="token punctuation">;</span> <span class="token comment">//当前时间</span>
  viewer<span class="token punctuation">.</span>timeline<span class="token punctuation">.</span><span class="token function">zoomTo</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> stop<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将视图设置为提供的时间。</span>

  viewer<span class="token punctuation">.</span>clock<span class="token punctuation">.</span>multiplier <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span> <span class="token comment">//加快播放速度</span>
  viewer<span class="token punctuation">.</span>clock<span class="token punctuation">.</span>shouldAnimate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">//时针向前走</span>
  <span class="token comment">//创建采样位置属性实例</span>
  <span class="token keyword">const</span> positionProperty <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>SampledPositionProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> dataPoint <span class="token operator">=</span> filghtData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> time <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>JulianDate<span class="token punctuation">.</span><span class="token function">addSeconds</span><span class="token punctuation">(</span>
      start<span class="token punctuation">,</span>
      i <span class="token operator">*</span> timeStepInSeconds<span class="token punctuation">,</span>
      <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>JulianDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> position <span class="token operator">=</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span>
      dataPoint<span class="token punctuation">.</span>longitude<span class="token punctuation">,</span>
      dataPoint<span class="token punctuation">.</span>latitude<span class="token punctuation">,</span>
      dataPoint<span class="token punctuation">.</span>height
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    positionProperty<span class="token punctuation">.</span><span class="token function">addSample</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> position<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//调用addSample方法将样本实例添加进去</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//添加飞机模型</span>
  <span class="token comment">// const airPlaneUri = Cesium.IonResource.fromAssetId(1980066).then((a)=&gt;{return a});</span>
  <span class="token comment">// console.log(airPlaneUri);</span>

  <span class="token keyword">const</span> airPlaneEntity <span class="token operator">=</span> viewer<span class="token punctuation">.</span>entities<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">//创建时间间隔集合</span>
    <span class="token literal-property property">availability</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>TimeIntervalCollection</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>TimeInterval</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">start</span><span class="token operator">:</span> start<span class="token punctuation">,</span> <span class="token literal-property property">stop</span><span class="token operator">:</span> stop <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//创建时间间隔</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> positionProperty<span class="token punctuation">,</span>
    <span class="token comment">//添加飞机模型</span>
    <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">uri</span><span class="token operator">:</span> <span class="token string">&quot;../public/GLB/Cesium_Air.glb&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">minimumPixelSize</span><span class="token operator">:</span> <span class="token number">128</span><span class="token punctuation">,</span>
      <span class="token literal-property property">maximumScale</span><span class="token operator">:</span> <span class="token number">20000</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">orientation</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>VelocityOrientationProperty</span><span class="token punctuation">(</span>positionProperty<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//设置方向与采样属性一致</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>PathGraphics</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//路径图形，并宽度为3</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  viewer<span class="token punctuation">.</span>trackedEntity <span class="token operator">=</span> airPlaneEntity<span class="token punctuation">;</span> <span class="token comment">//视角跟随飞机实体</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//12、添加三维建筑</span>
<span class="token keyword">const</span> <span class="token function-variable function">loadOSMBuildings</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  viewer<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
    <span class="token keyword">await</span> Cesium<span class="token punctuation">.</span>Cesium3DTileset<span class="token punctuation">.</span><span class="token function">fromIonAssetId</span><span class="token punctuation">(</span><span class="token number">96188</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//13、添加地形</span>
<span class="token keyword">const</span> <span class="token function-variable function">addTerrainProvider</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  viewer<span class="token punctuation">.</span>terrainProvider <span class="token operator">=</span>
    <span class="token keyword">await</span> Cesium<span class="token punctuation">.</span>ArcGISTiledElevationTerrainProvider<span class="token punctuation">.</span><span class="token function">fromUrl</span><span class="token punctuation">(</span>
      <span class="token string">&quot;https://elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">token</span><span class="token operator">:</span>
          <span class="token string">&quot;KED1aF_I4UzXOHy3BnhwyBHU4l5oY6rO6walkmHoYqGp4XyIWUd5YZUC1ZrLAzvV40pR6gBXQayh0eFA8m6vPg..&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">html,
body</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">*,
#app</span> <span class="token punctuation">{</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">#view_container</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100vw<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,10);function v(b,y){const a=p("ExternalLinkIcon");return e(),o("div",null,[r,k,n("p",null,[s("1、获取点位数据："),n("a",d,[s("构建飞行跟踪器 – Cesium (cesium.com)"),c(a)])]),m])}const w=t(u,[["render",v],["__file","14、Cesium实战三：飞行航线动画.html.vue"]]),h=JSON.parse('{"path":"/studyNotes/Cesium%E7%AC%94%E8%AE%B0/14%E3%80%81Cesium%E5%AE%9E%E6%88%98%E4%B8%89%EF%BC%9A%E9%A3%9E%E8%A1%8C%E8%88%AA%E7%BA%BF%E5%8A%A8%E7%94%BB.html","title":"14、飞行航线追踪","lang":"zh-CN","frontmatter":{"description":"14、飞行航线追踪 可视化从旧金山到哥本哈根的真实航班。 1、获取点位数据：构建飞行跟踪器 – Cesium (cesium.com) 2、在地图上添加飞行点位：循环遍历点位数据，利用Entity直接添加点至地图上。 3、将飞行点位连接起来，并创建飞行移动实体： 假设雷达样本采样间隔为30s,设定飞行开始时间，飞行结束时间由飞行开始时间+飞行持续时间计...","head":[["meta",{"property":"og:url","content":"https://mister-hope.github.io/studyNotes/Cesium%E7%AC%94%E8%AE%B0/14%E3%80%81Cesium%E5%AE%9E%E6%88%98%E4%B8%89%EF%BC%9A%E9%A3%9E%E8%A1%8C%E8%88%AA%E7%BA%BF%E5%8A%A8%E7%94%BB.html"}],["meta",{"property":"og:site_name","content":"歪脖祭司"}],["meta",{"property":"og:title","content":"14、飞行航线追踪"}],["meta",{"property":"og:description","content":"14、飞行航线追踪 可视化从旧金山到哥本哈根的真实航班。 1、获取点位数据：构建飞行跟踪器 – Cesium (cesium.com) 2、在地图上添加飞行点位：循环遍历点位数据，利用Entity直接添加点至地图上。 3、将飞行点位连接起来，并创建飞行移动实体： 假设雷达样本采样间隔为30s,设定飞行开始时间，飞行结束时间由飞行开始时间+飞行持续时间计..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-03-23T11:02:41.000Z"}],["meta",{"property":"article:author","content":"祭司唐"}],["meta",{"property":"article:modified_time","content":"2024-03-23T11:02:41.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"14、飞行航线追踪\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-03-23T11:02:41.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"祭司唐\\",\\"url\\":\\"\\"}]}"]]},"headers":[],"git":{"createdTime":1711191761000,"updatedTime":1711191761000,"contributors":[{"name":"tangwenjian","email":"gistwj@163.com","commits":1}]},"readingTime":{"minutes":5.21,"words":1562},"filePathRelative":"studyNotes/Cesium笔记/14、Cesium实战三：飞行航线动画.md","localizedDate":"2024年3月23日","excerpt":"\\n<p>可视化从旧金山到哥本哈根的真实航班。</p>\\n<p>1、获取点位数据：<a href=\\"https://cesium.com/learn/cesiumjs-learn/cesiumjs-flight-tracker/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">构建飞行跟踪器 – Cesium (cesium.com)</a></p>\\n<p>2、在地图上添加飞行点位：循环遍历点位数据，利用Entity直接添加点至地图上。</p>\\n<div class=\\"language-typescript\\" data-ext=\\"ts\\" data-title=\\"ts\\"><pre class=\\"language-typescript\\"><code><span class=\\"token comment\\">//添加飞行点位</span>\\n<span class=\\"token keyword\\">const</span> <span class=\\"token function-variable function\\">addFlightPoint</span> <span class=\\"token operator\\">=</span> <span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span> <span class=\\"token operator\\">=&gt;</span> <span class=\\"token punctuation\\">{</span>\\n  <span class=\\"token keyword\\">const</span> length <span class=\\"token operator\\">=</span> filghtData<span class=\\"token punctuation\\">.</span>length<span class=\\"token punctuation\\">;</span>\\n  <span class=\\"token keyword\\">for</span> <span class=\\"token punctuation\\">(</span><span class=\\"token keyword\\">let</span> i <span class=\\"token operator\\">=</span> <span class=\\"token number\\">0</span><span class=\\"token punctuation\\">;</span> i <span class=\\"token operator\\">&lt;</span> length<span class=\\"token punctuation\\">;</span> i<span class=\\"token operator\\">++</span><span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n    <span class=\\"token keyword\\">const</span> dataPoint <span class=\\"token operator\\">=</span> filghtData<span class=\\"token punctuation\\">[</span>i<span class=\\"token punctuation\\">]</span><span class=\\"token punctuation\\">;</span>\\n    viewer<span class=\\"token punctuation\\">.</span>entities<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">add</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">{</span>\\n      description<span class=\\"token operator\\">:</span> <span class=\\"token template-string\\"><span class=\\"token template-punctuation string\\">`</span><span class=\\"token string\\">Location:(</span><span class=\\"token interpolation\\"><span class=\\"token interpolation-punctuation punctuation\\">${</span>dataPoint<span class=\\"token punctuation\\">.</span>longitude<span class=\\"token interpolation-punctuation punctuation\\">}</span></span><span class=\\"token string\\">,</span><span class=\\"token interpolation\\"><span class=\\"token interpolation-punctuation punctuation\\">${</span>dataPoint<span class=\\"token punctuation\\">.</span>latitude<span class=\\"token interpolation-punctuation punctuation\\">}</span></span><span class=\\"token string\\">,</span><span class=\\"token interpolation\\"><span class=\\"token interpolation-punctuation punctuation\\">${</span>dataPoint<span class=\\"token punctuation\\">.</span>height<span class=\\"token interpolation-punctuation punctuation\\">}</span></span><span class=\\"token string\\">)</span><span class=\\"token template-punctuation string\\">`</span></span><span class=\\"token punctuation\\">,</span>\\n      position<span class=\\"token operator\\">:</span> Cesium<span class=\\"token punctuation\\">.</span>Cartesian3<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">fromDegrees</span><span class=\\"token punctuation\\">(</span>\\n        dataPoint<span class=\\"token punctuation\\">.</span>longitude<span class=\\"token punctuation\\">,</span> <span class=\\"token comment\\">//经度</span>\\n        dataPoint<span class=\\"token punctuation\\">.</span>latitude<span class=\\"token punctuation\\">,</span> <span class=\\"token comment\\">//纬度</span>\\n        dataPoint<span class=\\"token punctuation\\">.</span>height <span class=\\"token comment\\">//高度</span>\\n      <span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n      point<span class=\\"token operator\\">:</span> <span class=\\"token punctuation\\">{</span>\\n        pixelSize<span class=\\"token operator\\">:</span> <span class=\\"token number\\">8</span><span class=\\"token punctuation\\">,</span> <span class=\\"token comment\\">//点尺寸</span>\\n        color<span class=\\"token operator\\">:</span> Cesium<span class=\\"token punctuation\\">.</span>Color<span class=\\"token punctuation\\">.</span><span class=\\"token constant\\">RED</span><span class=\\"token punctuation\\">,</span> <span class=\\"token comment\\">//点颜色</span>\\n      <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n  <span class=\\"token punctuation\\">}</span>\\n<span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">;</span>\\n</code></pre></div>","autoDesc":true}');export{w as comp,h as data};
